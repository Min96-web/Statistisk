---
title: "Statistik och dataanalys I, 15 hp "
subtitle: "Inlamningsuppgift 1"
author: 
- Namn Minhui Zhong
- Namn Johanna Sel칬
date: last-modified
format: 
  html:
    self-contained: true
  pdf: default  
  docx: default
toc: true
language: 
  title-block-author-single: " "
toc-title-document: "Inneh친ll"
crossref-fig-title: "Figur"
theme: lumen
title-block-banner-color: Primary
title-block-published: "Publicerad"
callout-warning-caption: "Varning"
callout-note-caption: "Observera"
callout-tip-caption: "Tips"
editor: visual
---

::: callout-warning
Den h칛r inl칛mningsuppgiften f칬ruts칛tter att f칬ljande paket finns installerade:

-   `mosaic`

-   `dplyr`

-   `geosphere`

-   `leaflet`

Paket kan installeras via kommandot `install.packages('packagename')`, d칛r `'packagename'` 칛r namnet p친 paketet, t.ex `'mosaic'`.
:::

## Introduktion

I den f칬rsta inl칛mningsuppgiften ska ni sj칛lvst칛ndigt i grupper om tre analysera ett dataset i programmeringsspr친ket R. Till skillnad fr친n datorlaborationerna finns det minimalt med kodexempel. Datorlaborationerna g친r igenom de flesta momenten som behandlas i inl칛mningsuppgiften, s친 se till att g칬ra klart dessa innan.

------------------------------------------------------------------------

::: callout-note
### Instruktioner

I denna inl칛mningsuppgift ska ni analysera ett datamaterial som beskriver ca 500 distrikt i Boston 친r 1970. Datasetet 칛r en modifierad version[^1] av originaldata[^2] som anv칛ndes i en studie[^3] d칛r f칬rfattarna predikterade medianhuspriser i olika distrikt med hj칛lp av en rad f칬rklaringsvariabler.

F칬ljande variabler finns i datasetet `boston_census_data.Rdata` ([ladda ner](https://github.com/StatisticsSU/SDA1/blob/main/assignments/assignment1/Boston_census_data.RData?raw=true)), som inneh친ller 480 observationer. Notera att en observation motsvarar ett distrikt:

-   `town`: Stadsdel.
-   `longitude`: Longitud koordinat.
-   `latitude`: Latitud koordinat.
-   `median_home_value`: Medianhuspriset (enhet 1K USD).
-   `crime_rate`: Brott (per 1000 inv친nare).
-   `zoned_25k_p`: Andel av stadsdelens bostadsmark 칛mnad f칬r marklotter st칬rre 칛n 25000 kvadratfot.
-   `indust_p`: Andel tunnland 칛gd av f칬retag utanf칬r detaljhandel.
-   `borders_charles`: Charles River dummy variabel (= 1 om omr친det gr칛nsar till floden, 0 annars).
-   `NOx`: Koncentration av kv칛veoxider (andelar per 10 miljon).
-   `n_rooms_avg`: Genomsnitt antal rum i 칛gda bost칛der.
-   `before_1940_p`: Andel 칛gda bost칛der byggda f칬re 1940.
-   `employ_dist`: Viktat avst친nd till fem arbetsf칬rmedlingscentra i Boston.
-   `radial_access`: Index som m칛ter tillg친ng till stadsmotorv칛gar.
-   `tax_rate`: Fastighetsskatt per 10000 USD.
-   `pupil_teacher_ratio`: L칛rart칛thet m칛tt som elev per l칛rare.
-   `lower_stat_pct`: Procentandel med l친g socioekonomisk status i termer av utbildning eller arbete.
-   `dist_fenway_park`: Avst친nd till stadion Fenway Park.

Inl칛mningsuppgiften ska l칛mnas in i form av ett html-dokument genererat av Quarto. **Kontrollera att ni inte f친r n친gra felmeddelande n칛r du genererar HTML-dokumentet. L칛s sedan igenom HTML-dokumentet noggrant innan ni l칛mnar in det.** Anv칛nd tydliga figurer och namnge axlarna med tydliga variabelnamn. Gl칬m inte att skriva era namn i b칬rjan av dokumentet, d칛r det nu st친r Namn 1, Namn 2 och Namn 3.
:::

[^1]: Totalunders칬kningen trunkerade medianhusv칛rdet till 50K f칬r de censusdistrikten som l친g 칬ver. Vi har tagit bort dessa censusdistrikt. Vi har ocks친 tagit bort variabler som 칛r irrelevanta.

[^2]: Harrison Jr, D., & Rubinfeld, D. L. (1978). Hedonic housing prices and the demand for clean air. Journal of Environmental Economics and Management, 5(1), 81-102.

[^3]: Pace, R. K., & Gilley, O. W. (1997). Using the spatial configuration of the data to improve estimation. The Journal of Real Estate Finance and Economics, 14(3), 333-340.

## 0. Ladda in data

#### 游눩 Uppgift 0.1

Ladda in datasetet `Boston_census_data` med f칬ljande kod.

::: {.callout-note appearance="minimal"}
# Uppgift 0.1 - Svar

```{r}
load(file = url("https://github.com/StatisticsSU/SDA1/blob/main/assignments/assignment1/Boston_census_data.RData?raw=true")) 
Boston_census <- Boston_census_data
Boston_census
```
:::

```{r}
suppressMessages(library(geosphere))
suppressMessages(library(leaflet))
```

## 1. Kriminalitet i Boston

I detta avsnitt ska ni analysera kriminaliteten i Boston med hj칛lp av variabeln `crime_rate`.

#### 游눩 Uppgift 1.1

Vad kan man generellt s칛ga om kriminaliteten i Boston 1970? Anv칛nd l칛mpliga figurer och m친tt f칬r att ge en beskrivning.

::: {.callout-note appearance="minimal"}
# Uppgift 1.1 - Svar

<div>

Skriv svaret h칛r. Vid behov skrivs matematiska symboler inom dollartecken, till exempel $\overline{y} = \cfrac{\sum^{n}_{i=1} y_i}{n}$. Koden skrivs i R-rutan nedanf칬r.

</div>

```{r}
suppressMessages(library(mosaic))
favstats(~crime_rate, data = Boston_census)
bwplot(~crime_rate, data = Boston_census)
Crime_rate = Boston_census[,5]
Crime_rate
log_crime_rate <- log(Crime_rate)
log_crime_rate
bwplot(log_crime_rate) #transformerad plot
#svar: Vi kan s칛ga att enligt beskrivningen ser vi att crime_rate variabeln har medelv칛rdet 칛r ca 3.67 och histogram kan vi ta reda p친 en del outlier som p친verkar v친r medelv칛rdet. Generellt kan vi s칛ga Boston 1970 har low kriminaliteten.
```
:::

#### 游눩 Uppgift 1.2

Distrikten tillh칬r olika stadsdelar som anges i den kategoriska variabeln `town`? Det finns 88 olika s친dana stadsdelar (towns).

*Skiljer sig brottsligheten 친t mellan de olika stadsdelarna?* Unders칬k stadsdelarna `Boston East Boston`, `Boston Downtown`, `Cambridge`, samt ytterligare en stadsdel som ni sj칛lva v칛ljer. Besvara fr친gan med hj칛lp av l칛mpligt valda figurer och statistiska m친tt.

::: callout-tip
Innan ni p친b칬rjar analysen, skapa en ny data frame som enbart inneh친ller de stadsdelar som ni vill j칛mf칬ra. Det kan g칬ras till exempel med funktionen `filter()`.
:::

::: {.callout-note appearance="minimal"}
# Uppgift 1.2 - Svar

Skriv svaret h칛r.

```{r}
suppressMessages(library(dplyr))
Boston_census_new <- filter(Boston_census, town == "Boston East Boston" |town == "Boston Downtown" |town == "Cambridge" | town == "Newton")
Boston_census_new
boxplot(crime_rate ~ town, data = Boston_census_new)
histogram(~ crime_rate | town, data = Boston_census_new,type = "percent")
favstats(~ crime_rate | town, data = Boston_census_new)
# Enligt histogram som vi skapade kan vi tydligt se att Boston Downtown har h칬gre crime_rate 칛n de resten grupperna. I och med enligt deskriptiv data som vi fick i figuren 3 d칛r har Boston Downtown h칬gst medelv칛rdet j칛mf칬rt med de resten grupperna dvs vi kan dra ett beslut att Boston Downtown har en h칬gre brottslighet 칛n de resten grupperna.
```
:::

#### 游눩 Uppgift 1.3

Vilka tv친 variabler i datasetet `Boston_census_data` korrelerar mest med brottslighet? Beskriv sambandet mellan brottslighet och var och en av dessa tv친 variabler.

::: callout-tip
Kom ih친g att korrelation m칛ter det linj칛ra sambandet mellan *numeriska variabler*.
:::

::: {.callout-note appearance="minimal"}
# Uppgift 1.3 - Svar

Skriv svaret h칛r.

```{r}
suppressMessages(library(mosaic))
Boston_census_data_13_variables <- Boston_census_data[, c("longitude","latitude","median_home_value","crime_rate","zoned_25k_p","indust_p","NOx","n_rooms_avg","before_1940_p","employ_dist","pupil_teacher_ratio","lower_stat_pct","dist_fenway_park")]
head(Boston_census_data_13_variables)
correlation_matrix_Boston <- cor(Boston_census_data_13_variables)
#vi ser att variabel lower_stat_pct har en stark positiv korrelation ungef칛r 0,35 till crime_rate, variabel median_home_value har dock en stark negativ korrelation ungef칬r -0.45 till crime_rate.
round(correlation_matrix_Boston, 3)
suppressMessages(library(corrplot))
corrplot(correlation_matrix_Boston)
cor(lower_stat_pct ~ Crime_rate, data = Boston_census)
cor(median_home_value ~ Crime_rate, data = Boston_census)
```
:::

## 2. Fastighetsskatt i Boston

I detta avsnitt ska ni analysera fastighetsskatten i Boston med hj칛lp av variabeln `tax_rate`.

#### 游눩 Uppgift 2.1

Vad kan man generellt s칛ga om fastighetsskatten i distrikten? Anv칛nd l칛mpliga figurer och m친tt f칬r att beskriva f칬rdelningen.

::: {.callout-note appearance="minimal"}
# Uppgift 2.1 - Svar

Skriv svaret h칛r.

```{r}
histogram(~tax_rate, data = Boston_census_data, main ="Fastighetsskatten i Boston", type ="count",col="navyblue")
favstats(~ tax_rate, data = Boston_census)
densityplot(~ tax_rate, data = Boston_census_data, col = "red")
```
:::

#### 游눩 Uppgift 2.2

L친t oss skapa en ny variabel `cat_tax` som anger om ett distrikt betalar l친g (`low`), medel (`medium`), eller h칬g (`high`) fastighetsskatt. Vi definerar skattekategorierna enligt

-   `low`: `tax_rate` $\leq$ 250,
-   `medium`: 250 $<$ `tax_rate` $\leq$ 400,
-   `high`: `tax_rate` $>$ 400.

F칬ljande kod skapar och l칛gger till variabeln `cat_tax` i `Boston_census_data`

```{r}
Boston_census_data$cat_tax <- cut(Boston_census_data$tax_rate, 
              breaks=c(0, 250, 400, 800),
              labels=c('Low', 'Medium', 'High'))
```

Finns det ett samband mellan vilken skattekategori ett distrikt tillh칬r och dess angr칛nsning till Charles River? F칬rklara med hj칛lp av l칛mplig tabell och figur.

::: {.callout-note appearance="minimal"}
# Uppgift 2.2 - Svar

Skriv svaret h칛r.

```{r}
tally(cat_tax ~ borders_charles, data = Boston_census_data, margins=TRUE, format="percent")
```
:::

#### 游눩 Uppgift 2.3

Hur m친nga procent av alla distrikt i v친r data ligger i angr칛nsning till Charles River *och* tillh칬r en h칬g skattekategori? Hur stor andel av distrikten med h칬g skatt ligger *inte* i angr칛nsning till Charles River?

::: {.callout-note appearance="minimal"}
# Uppgift 2.3 - Svar

Skriv svaret h칛r.

```{r}
tally(borders_charles ~ cat_tax, data = Boston_census_data, margins=TRUE, format="percent")

```
:::

#### 游눩 Uppgift 2.4

Vilka tv친 variabler i datasetet `Boston_census_data` korrelerar starkast med `tax_rate`? Beskriv det parvisa sambandet mellan `tax_rate` och var och en av dessa tv친 variabler. Vad kan vi s칛ga om kausalitet f칬r vart och ett av sambanden?

::: callout-tip
Kom ih친g att korrelation 칛r ett m친tt p친 linj칛ra samband mellan *numeriska variabler*.
:::

::: {.callout-note appearance="minimal"}
# Uppgift 2.4 - Svar

Skriv svaret h칛r.

```{r}
suppressMessages(library(mosaic))
#vi ser att variabel lower_stat_pct har en stark positiv korrelation ungef칛r 0,35 till crime_rate, variabel median_home_value har dock en stark negativ korrelation ungef칬r -0.45 till crime_rate.
Boston_census_data_15_variables <- Boston_census_data[, c("longitude","latitude","median_home_value","crime_rate","zoned_25k_p","indust_p","NOx","n_rooms_avg","before_1940_p","employ_dist","radial_access","tax_rate","pupil_teacher_ratio","lower_stat_pct","dist_fenway_park")]
head(Boston_census_data_15_variables)
correlation_matrix_Boston <- cor(Boston_census_data_15_variables)
round(correlation_matrix_Boston, 3)
corrplot(correlation_matrix_Boston)
cor(radial_access ~ tax_rate, data = Boston_census)
cor(indust_p ~ tax_rate, data = Boston_census)
```
:::

## 3. Avst친nd till Fenway park

I detta avsnitt ska ni unders칬ka variabeln `dist_fenway_park`, som m칛ter avst친ndet mellan ett distrikt och Fenway park (stadion d칛r basebollslaget Boston Red Sox spelar sina hemmamatcher).

Vi kan visualisera Fenway park och distrikten p친 en karta med hj칛lp av R-paketet `leaflet`. F칬ljande kod visar platsen f칬r Fenway park och distrikten f칬r observationerna 30 och 45.

```{r}
#| eval: false
library(leaflet) # Install if not available
fenway_park_lat_long <- c(42.346462, -71.097250) # latitude and longitude for Fenway_park
Boston_map <- leaflet() %>% 
  addTiles() %>%
  addMarkers(lat = fenway_park_lat_long[1], lng = fenway_park_lat_long[2], popup="Fenway park") %>%
  addMarkers(lat = Boston_census_data$latitude[30], lng = Boston_census_data$longitude[30], popup="Observation 30") %>%
  addMarkers(lat = Boston_census_data$latitude[45], lng = Boston_census_data$longitude[45], popup="Observation 45") 

Boston_map # Show interactive map
```

#### 游눩 Uppgift 3.1

Vilket distrikt i v친r data har l칛ngst respektive kortast avst친nd till Fenway park? Markera ut dessa distrikt i en interaktiv karta tillsammans med Fenway park.

::: {.callout-note appearance="minimal"}
# Uppgift 3.1 - Svar

Skriv svaret h칛r.

```{r}
#| eval: false
dist_fenway_sorted <- Boston_census_data %>% arrange(dist_fenway_park)
head(dist_fenway_sorted)
dist_fenway_sorted_hightolow <- Boston_census_data %>% arrange(desc(dist_fenway_park))
head(dist_fenway_sorted_hightolow)

library(leaflet) # Install if not available
fenway_park_lat_long <- c(42.346462, -71.097250) # latitude and longitude for Fenway_park
Boston_map <- leaflet() %>% 
  addTiles() %>%
  addMarkers(lat = fenway_park_lat_long[1], lng = fenway_park_lat_long[2], popup="Fenway park") %>%
  addMarkers(lat = dist_fenway_sorted$latitude[1], lng = dist_fenway_sorted$longitude[1], popup="kortast") %>%
  addMarkers(lat = dist_fenway_sorted_hightolow$latitude[1], lng = dist_fenway_sorted_hightolow$longitude[1], popup="Observation l칛ngst") 
Boston_map
```
:::

#### 游눩 Uppgift 3.2

Finns det ett samband mellan `dist_fenway_park` och `crime_rate`?

::: {.callout-note appearance="minimal"}
# Uppgift 3.2 - Svar

Skriv svaret h칛r.

```{r}
cor(dist_fenway_park ~ crime_rate, data = Boston_census_data)
```
:::

## 4. Enkel linj칛r regression

I detta avsnitt ska ni anpassa och tolka enkla linj칛ra regressionsmodeller.

#### 游눩 Uppgift 4.1

Anpassa en linj칛r regression med responsvariabeln `NOx` och den f칬rklarande variabeln `employ_dist`. Rita den anpassade regressionslinjen tillsammans med data i en l칛mplig figur. Beskriv resultaten och tolka modellen. Utf칬r en modellvalidering via en residualanalys och kommentera modellens l칛mplighet. Om modellen inte anses l칛mplig, vilka antaganden har inte varit uppfyllda?

::: {.callout-note appearance="minimal"}
# Uppgift 4.1 - Svar

Skriv svaret h칛r.

```{r}
#Vi anpassar en enkel linj칛r regression med responsvariabel utandningsvolymen (NOx) och f칬rklarande variabel l칛ngd (employdist) med hj칛lp av funktionen lm() som st친r f칬r linear model och sparar resultatet i en variabel vi d칬per till lm_NOx_vs_employdist.
lm_NOx_vs_employdist <- lm(NOx ~ employ_dist, data = Boston_census)
lm_NOx_vs_employdist
#En s친dan funktion 칛r summary() som skriver ut resultaten fr친n regressionen i ett snyggt format.
summary(lm_NOx_vs_employdist)

plot(NOx ~ employ_dist, data = Boston_census, col = "cornflowerblue", ylim = c(0, 1))
y_hat <- predict(lm_NOx_vs_employdist)
head(y_hat)
lines(Boston_census$employ_dist, y_hat, type = "p", col = "lightcoral")
abline(lm_NOx_vs_employdist, col = "lightcoral")
legend(x = "topleft", pch = c(1, 1, NA), lty = c(NA, NA, 1), col = c("cornflowerblue", "lightcoral", "lightcoral"), legend=c("Data", "Predicted", "Fitted line"))

# residualer
resid <- residuals(lm_NOx_vs_employdist)
head(resid)

# residualanalys
plot(Boston_census$employ_dist, resid, xlab= "employ_dist", ylab='Residuals', col = "cornflowerblue") 
qqnorm(resid, col = "cornflowerblue") # Create normal probability plot for residuals
qqline(resid, col = "red") # Add a straight line to normal probability plot 

# Den 칛r inte s친 slumpm칛ssig, inte normalf칬rdelad. 
# enkel linj칛r regression 

```
:::

#### 游눩 Uppgift 4.2

Anv칛nd modellen i Uppgift 4.1 f칬r att prediktera koncentration av kv칛veoxider f칬r observation 10, d칛r `employ_dist`=10.5857. Ber칛kna vad residualen blir f칬r denna observation.

::: {.callout-note appearance="minimal"}
# Uppgift 4.2 - Svar

Skriv svaret h칛r.

```{r}
new_x <- data.frame(employ_dist = c(10.5857))
predict(lm_NOx_vs_employdist, newdata = new_x)
```
:::

#### 游눩 Uppgift 4.3

Transformera variablerna i Uppgift 4.1 (avg칬r sj칛lv vilken eller vilka av de tv친 som beh칬ver transformeras). Ett f칬rslag 칛r att anv칛nda Tukeys cirkel f칬r att hitta l칛mpliga transformationer. Anpassa en ny linj칛r regression med de transformerade variablerna. Utf칬r en modellvalidering (efter transformation) via en residualanalys och kommentera modellens l칛mplighet j칛mf칬rt med modellen i Uppgift 4.1.

::: {.callout-note appearance="minimal"}
# Uppgift 4.3 - Svar

Skriv svaret h칛r.

```{r}
plot(NOx ~ employ_dist, data = Boston_census,col = "cornflowerblue") 
# Starting point: Both y and x  untransformed (Step 2 in the ladder of powers) 
plot(sqrt(NOx) ~ sqrt(employ_dist), data = Boston_census, col = "cornflowerblue")
# y down and x down in the ladder of powers
plot(log(NOx) ~ log(employ_dist), data = Boston_census, col = "cornflowerblue")
# y and x down two steps

lm_logNOx_vs_logemploy_dist <- lm(log(NOx) ~ log(employ_dist), data = Boston_census)
summary(lm_logNOx_vs_logemploy_dist)
logy_hat <- predict(lm_logNOx_vs_logemploy_dist) # log scale prediction
y_hat <- exp(logy_hat) # original scale prediction
head(logy_hat)
head(y_hat)
plot(NOx ~ employ_dist, data = Boston_census, col = "cornflowerblue", ylim = c(0, 7)) # Data on original scale
lines(Boston_census$employ_dist, y_hat, type = "p", col = "lightcoral")
abline(lm_logNOx_vs_logemploy_dist, col = "lightcoral")
legend(x = "topleft", pch = c(0,5, 0,5, NA), lty = c(NA, NA, 0,5), col = c("cornflowerblue", "lightcoral", "lightcoral"), legend=c("Data", "Predicted", "Fitted line"))


```
:::

#### 游눩 Uppgift 4.4

Plotta den anpassade regressionen fr친n 4.3 i icke-transformerad skala tillsammans med observationerna (ocks친 i icke-transformerad skala) i en l칛mplig figur.

::: {.callout-note appearance="minimal"}
# Uppgift 4.4 - Svar

Skriv svaret h칛r.

```{r}
# Write your code here
```
:::

#### 游눩 Uppgift 4.5

Anv칛nd modellen i Uppgift 4.3 f칬r att prediktera koncentration av kv칛veoxider i icke-transformerad skala f칬r observation 10, d칛r `employ_dist`=10.5857. Ber칛kna vad residualen blir f칬r denna observation. Kommentera resultaten j칛mf칬rt med Uppgift 4.2.

::: callout-tip
T칛nk p친 att ta h칛nsyn till eventuella transformationer!
:::

::: {.callout-note appearance="minimal"}
# Uppgift 4.5 - Svar

Skriv svaret h칛r.

```{r}
# Write your code here
```
:::

## 5. Multipel linj칛r regression

I detta avsnitt ska ni studera multipel linj칛ra regression.

#### 游눩 Uppgift 5.1

Anpassa en linj칛r regression med responsvariabel logaritmerad `median_home_value` samt f칬rklarande variabler `lower_stat_pct` och dummy-variabeln `borders_charles`. Tolka koefficienten f칬r `borders_charles`.

::: {.callout-note appearance="minimal"}
# Uppgift 5.1 - Svar

Skriv svaret h칛r.

```{r}
lm_median_home_value_vs_lower_stat_pct_borders_charles <- lm(median_home_value ~ lower_stat_pct + borders_charles, data = Boston_census)
summary(lm_median_home_value_vs_lower_stat_pct_borders_charles)

resid_median_multiplereg <- residuals(lm_median_home_value_vs_lower_stat_pct_borders_charles)
head(resid_median_multiplereg)
plot(lm_median_home_value_vs_lower_stat_pct_borders_charles$fitted.values, resid_median_multiplereg, xlab= "y_hat", ylab='Residuals', col = "cornflowerblue") 
qqnorm(resid_median_multiplereg, col = "cornflowerblue") # Create normal probability plot for residuals
qqline(resid_median_multiplereg, col = "red") # Add a straight line to normal
```
:::

#### 游눩 Uppgift 5.2

Ni ska nu utforma en modell som predikterar medianhuspriset `median_home_value`. Ni f친r endast anv칛nda f칬ljande f칬rklaringsvariabler:

-   `before_1940_p`
-   `crime_rate`
-   `radial_access`
-   `NOx`
-   `dist_fenway_park`

Ni f친r sj칛lva v칛lja hur m친nga av variablerna som ska ing친 i modellen. Ni f친r g칬ra vilka transformationer ni vill av variablerna, inklusive responsvariabeln.

Pr칬va er fram metodiskt n칛r ni v칛ljer vilka variabler ni inkluderar i modellen, och n칛r ni best칛mmer vilka eventuella transformationer ni anv칛nder.

N칛r ni utv칛rderar olika modeller kan ni f칬rslagsvis b칬rja med att j칛mf칬ra adjusted R-squared. N칛r ni med hj칛lp av adjusted R-squared har identifierat tv친 eller tre modeller som ser lovande ut kan ni utv칛rdera dessa modeller ytterligare i ett andra steg.

I det andra steget ska ni utv칛rdera hur v칛l modellerna predikterar data som *inte* anv칛nts f칬r att anpassa modellen. Ni kan v칛lja *en av tv친 alternativa metoder*:

1.  Dela in ert dataset i tr칛ningsdata och testdata. Anpassa modellen med hj칛lp av tr칛ningsdata, och utv칛rdera sedan p친 testdata. Ni kan exempelvis anv칛nda de f칬rsta 350 observationerna som tr칛ningsdata och de sista 130 observationerna som testdata.
2.  Anv칛nd korsvalidering. Det 칛r en n친got mer kr칛vande metod, men ocks친 n친got b칛ttre. Ni kan exempelvis g칬ra korsvalidering med 4 folds (4-fold cross validation). Dela d친 upp ert dataset i fyra delar (del 1: observationer 1-120, del 2: observationer 121-240, del 3: observationer 241-360, del 4: observationer 361-480).

*Sortera inte observationerna i `Boston_census_data` slumpm칛ssigt. Ordningen 칛r redan slumpm칛ssig.*

::: callout-tip
T칛nk p친 att ta h칛nsyn till eventuell transformation av responsvariabeln. Om ni exempelvis har valt transformationen $\log(y)$ 칛r modellens prediktion av responsvariabeln $\widehat{\log(y)}$. Ni m친ste d친 transformera den till $\hat y$ i responsvariabelns originalskala med formeln $\hat{y}=\exp\left(\widehat{\log(y)}\right)$. Sedan kan ni r칛kna ut residualen $y - \hat y$.
:::

::: {.callout-note appearance="minimal"}
# Uppgift 5.2 - Svar

Skriv svaret h칛r

```{r}
plot(median_home_value ~ before_1940_p + NOx, data = Boston_census, col = "cornflowerblue")

lm_sqrtmedian_home_value_vs_before_1940_p_NOx <- lm(sqrt(median_home_value) ~ before_1940_p ~ NOx, data = Boston_census)
sqrty_hat <- predict(lm_sqrtDHR_vs_duration) # sqrt scale prediction
y_hat <- sqrty_hat^2 # original scale prediction
plot(dive_heart_rate ~ duration, data = penguins, col = "cornflowerblue", ylim = c(0, 140), main = "Model 1") # Data on original scale
lines(penguins$duration, y_hat, type = "p", col = "lightcoral")
legend(x = "topright", pch = c(1, 1), col = c("cornflowerblue", "lightcoral"), legend=c("Data", "Predicted"))
# Write your code here
```
:::

#### 游눩 Uppgift 5.3

G칬r en residualanalys av den valda modellen i Uppgift 5.2.

::: {.callout-note appearance="minimal"}
# Uppgift 5.3 - Svar

Skriv svaret h칛r.

```{r}
# Write your code here
```
:::

#### 游눩 Uppgift 5.4

Anv칛nd modellen i Uppgift 5.2 f칬r att prediktera medianhuspriset f칬r observationerna i datasetet `Boston_districts_to_predict` ([ladda ner](https://github.com/StatisticsSU/SDA1/blob/main/assignments/assignment1/Boston_districts_to_predict.RData?raw=true)).

::: {.callout-note appearance="minimal"}
# Uppgift 5.4 - Ladda hem data f칬r prediktion

Ladda in dataseten `Boston_districts_to_predict` med f칬ljande kod.

```{r}
# Write your code here
load(file = url("https://github.com/StatisticsSU/SDA1/blob/main/assignments/assignment1/Boston_districts_to_predict.RData?raw=true")) 
```
:::

Det h칛r datasetet har endast de f칬rklarande variablerna, dvs inte responsvariabeln. N칛r vi r칛ttar era inl칛mningsuppgifter kommer vi att j칛mf칬ra era prediktioner med de faktiska medianpriserna (som vi har tillg친ng till).

Skriv ut dina prediktioner s친 att vi enkelt kan se dem n칛r vi r칛ttar.

::: callout-tip
T칛nk p친 att ta h칛nsyn till eventuella transformationer av f칬rklaringsvariablerna!
:::

::: {.callout-note appearance="minimal"}
# Uppgift 5.4 - Svar

Skriv svaret h칛r.

```{r}
# Write your code here
```
:::
